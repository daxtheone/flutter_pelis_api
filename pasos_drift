
1) instalar  drift   https://drift.simonbinder.eu/setup/




dependencies:

  drift: ^2.29.0
  drift_flutter: ^0.2.7
  path_provider: ^2.1.5

    https://pub.dev/packages/drift_flutter/install
    https://pub.dev/packages/drift/install
    https://pub.dev/packages/path_provider/install


dev_dependencies:
  drift_dev: ^2.29.0
    build_runner: ^2.9.0
    https://pub.dev/packages/drift_dev/install


2) Creamos la base de datos

    /lib/config/database/database.dart

        import 'package:drift/drift.dart';
        import 'package:drift_flutter/drift_flutter.dart';
        import 'package:path_provider/path_provider.dart';

        part 'database.g.dart';
        /*
        class TodoItems extends Table {
          IntColumn get id => integer().autoIncrement()();
          TextColumn get title => text().withLength(min: 6, max: 32)();
          TextColumn get content => text().named('body')();
          DateTimeColumn get createdAt => dateTime().nullable()();
        }
        */



        class FavoriteMovies extends Table {
          IntColumn get id => integer().autoIncrement()();
          IntColumn get movieId => integer().named('movie_id')();
          TextColumn get backdropPath => text().named('backdrop_path')();
          TextColumn get originalTitle => text().named('original_title')();
          TextColumn get posterPath => text().named('poster_path')();
          TextColumn get title => text()();
          RealColumn get voteAverage => real().named('vote_average').withDefault(const Constant(0.0))();


        }




        @DriftDatabase(tables: [FavoriteMovies])
        class AppDatabase extends _$AppDatabase {
          // After generating code, this class needs to define a `schemaVersion` getter
          // and a constructor telling drift where the database should be stored.
          // These are described in the getting started guide: https://drift.simonbinder.eu/setup/
          AppDatabase([QueryExecutor? executor]) : super(executor ?? _openConnection());

          @override
          int get schemaVersion => 1;

          static QueryExecutor _openConnection() {
            return driftDatabase(
              name: 'my_database',
              native: const DriftNativeOptions(
                // By default, `driftDatabase` from `package:drift_flutter` stores the
                // database files in `getApplicationDocumentsDirectory()`.
                databaseDirectory: getApplicationSupportDirectory,
              ),
              // If you need web support, see https://drift.simonbinder.eu/platforms/web/
            );
          }
        }

        final db = AppDatabase();

    3) En Main.dart

    Future<void> main() async{
      WidgetsFlutterBinding.ensureInitialized();
      await dotenv.load(fileName: '.env');
      runApp( const ProviderScope(child: MyApp()) );
    }


    4) en main.dart podemos probar


    Future<void> main() async{
      /*WidgetsFlutterBinding.ensureInitialized();

      await db.into(db.favoriteMovies).insert(
       FavoriteMoviesCompanion.insert(movieId: 1, backdropPath: 'backdropPath.png', originalTitle: 'Daniel frankestein', posterPath: 'png.pgn', title: 'Frankestainsss')
      );
      final deleteQuery = db.delete(db.favoriteMovies);
      await deleteQuery.go();
      final movies = await db.select(db.favoriteMovies).get();
      print('movies: $movies');
      */


 5) creamos nuestra implentacion para acceder a datos locales

 domain/datasources/local_storage_datasrouce.dart


 import 'package:pelis_api/domain/entities/movie.dart';

 abstract class LocalStorageDatasource {
   Future<void> toggleFavoriteMovie(Movie movie);

   Future<bool> isFavoriteMovie(int movieId);

   Future<List<Movie>> loadFavoriteMovies({int limit = 10, int offset = 0});
 }



 6 ) Creamos ahora como segundo paso el repositorio


    domain/repositories/local_storage_repository.dart



 7 ) ahora en la capa de infreastructure creamos el archivo

 /infrastructure/datasources/drift_datasource.dart



y extendemos del punto 6
class DriftDatasource extends LocalStorageDatasource{



8 ) ahora nos vamos el repositorio


/infrastructure/repositories/local_storage_repository.dart




